<p id="notice"><%= notice %></p>

<div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
  <ol class="carousel-indicators">
    <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
    <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
    <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
  </ol>
  <div class="carousel-inner">
    <div class="carousel-item active">
      <%= image_tag(@product.imageString, class: "img-fluid") %>
    </div>
    <div class="carousel-item">
      <%= image_tag(@product.imageString, class: "img-fluid") %>
    </div>
    <div class="carousel-item">
      <%= image_tag(@product.imageString, class: "img-fluid") %>
    </div>
  </div>
  <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div>

<p>
  <strong>Company:</strong>
  <%= @product.company %>
</p>

<p>
  <strong>Title:</strong>
  <%= @product.title %>
</p>
<p>
  <strong>Description:</strong>
  <%= @product.description %>
</p>

<p>
  <strong>Price:</strong>
  <%= @product.price %>
</p>
<div id="div_id">
 <%= render partial: "shared/save_product", locals: {product: @product} %>
 </div>

<%= link_to 'Edit', edit_product_path(@product) %> 
<%= link_to 'Back', products_path %>
<%= form_with local:true, url: cart_items_path(:product_id => @product.id) do |form| %>

  <div class="mb-3">
    <%= form.label :size %>
    <%= select_tag :size, options_for_select(@availableSizes ), id: "size-list"%>
  </div>

  <div class="mb-3">
    <%= form.label :colour %>
    <%= select_tag :colour, options_for_select(@availableColours), id: "colour-list" %>
  </div>
  <h3><%= @availableColors%></h3>
  <div class="mb-3">
    <%= form.label :quantity %>
    <%= select_tag :quantity, options_for_select((1..@availableQuantity[0]).to_a), id: "quantity-list" %>
  </div>
  <div class="mb-3">
    <%= form.submit "Add To Cart", class: "btn btn-primary" %>
  </div>
  
  <%end%>
  
<script>
  $("#size-list").change(function(){
    var url = window.location.pathname + "/setAvailableColours"+ ""
  $.ajax({
    url: url,
    dataType: 'json',
    data: {size: $(this).val()},
    type: 'GET',
    success: function(data){ 
     $("#colour-list").children().remove();
      // Create options and append to the list
      var listitems = []; 
      $.each(data,function(key, value) { 
        
        listitems += '<option value="' + value+ '">' + value + '</option>';    }); 
    $("#colour-list").append(listitems);
    
     },
     complete: function(){setQuantity()}
  });
  
});


  $("#colour-list").change(setQuantity);
  
 function setQuantity(){
    var url = window.location.pathname + "/setAvailableQuantity"+ ""
  $.ajax({
    url: url,
    dataType: 'json',
    data: {size: $("#size-list").val(), colour: $("#colour-list").val() },
    type: 'GET',
    success: function(data){ 
     $("#quantity-list").children().remove();
      // Create options and append to the list
      var listitems = []; 
      for(var i = 1; i <= data[0]; i++){ 
        
        listitems += '<option value="' + i+ '">' + i + '</option>';    }
    $("#quantity-list").append(listitems);
     }
  });
}

</script>

